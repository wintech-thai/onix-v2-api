#!/bin/bash

export $(grep -v '^#' .env | xargs)

ACCESS_TOKEN="eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJHOTV2ajMtZDlJQ0otNEJuZ09iUkY2MVlpNzBMR01jQkpuZklISmFoRkFJIn0.eyJleHAiOjE3NTc2NTU3MjgsImlhdCI6MTc1NzY1NTQyOCwianRpIjoiMjg0MjdlYzktMzMwYS00YzFlLTg2MDUtNTM4M2Q5ZGE4Mjg3IiwiaXNzIjoiaHR0cHM6Ly9rZXljbG9hay5kZXZvcHMubmFwYmlvdGVjLmlvL2F1dGgvcmVhbG1zL29uaXgtdjItZGV2IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjhmMzZlNDlmLTljM2MtNGFjMi05MTdiLTBlN2I0ZDIyZWUzNiIsInR5cCI6IkJlYXJlciIsImF6cCI6InBsZWFzZS1zY2FuIiwic2Vzc2lvbl9zdGF0ZSI6IjdiYmY3ZWRkLWY1ZTUtNGZhOC05MGUwLWYwODc2NmZlZjRiZiIsImFjciI6IjEiLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJkZWZhdWx0LXJvbGVzLW9uaXgtdjItZGV2IiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCBwcm9maWxlIGVtYWlsIG9mZmxpbmVfYWNjZXNzIiwic2lkIjoiN2JiZjdlZGQtZjVlNS00ZmE4LTkwZTAtZjA4NzY2ZmVmNGJmIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiU2V1YnBvbmcgTW9uc2FyIiwicHJlZmVycmVkX3VzZXJuYW1lIjoic2V1YnBvbmcubW9uIiwiZ2l2ZW5fbmFtZSI6IlNldWJwb25nIiwiZmFtaWx5X25hbWUiOiJNb25zYXIiLCJlbWFpbCI6InBqYW1lLmZiQGdtYWlsLmNvbSJ9.aeI2GdGxKCL1JzBjCy_tHhJ6D3VuJqSB0mBz_FLXzX6ZrBNIc8FQmuD91ek7T8zvaBR28cARHZZ2AlUy6mfbD_mb16X4AJYWcJSbB2Xw4y6O3RnrsaZ8yBumPr98UWXMm0PBiyg2PWtc7k84CPz54dSDnCB6Lcaj48_WH5sxGvMH7DYS0uJPNjzhOLdLzqwD_iCcWgSbl36Y2ToqSV1S_iVW_AY3nhJKJbJeNbyQlL5MJWYIG6X_4XlrjVlyFUiD4wd1bj5gSocncAxOHS1WWHirsTLQQhYbHKfnRW6P9jMk1cnzKzpKzYX9iPOcBR5-7s-DtP-A6GMtQ_iDEdT00w"
ACCESS_TOKEN_B64=$(echo -n "${ACCESS_TOKEN}" | base64 -w0)

#curl -s -X GET ${API_HTTP_ENDPOINT}/api/Organization/org/${API_ORG}/action/GetUserAllowedOrg \
#-H "Content-Type: application/json" -v -u "dummy:${API_KEY}"

curl -s -X GET ${API_HTTP_ENDPOINT}/api/Organization/org/${API_ORG}/action/GetUserAllowedOrg \
-H "Content-Type: application/json" -v \
-H "Authorization: Bearer ${ACCESS_TOKEN_B64}"
